# Copyright 2007 Bryan Ã˜stergaard
# Distributed under the terms of the GNU General Public License v2

SUMMARY="Linux kernel headers"
HOMEPAGE="http://www.kernel.org"
SOURCES="mirror://kernel/linux/kernel/v2.6/linux-${PV}.tar.bz2"

LICENCES="GPL-2"
SLOT="0"
PLATFORMS="~amd64 ~ia64 ~x86"
MYOPTIONS=""

DEPENDENCIES=""

S="${WORKDIR}/linux-${PV}"

# FIXME: Need to sanitize headers at some point
DEFAULT_SRC_PREPARE_PATCHES=(
    "${FILESDIR}"/${P}-includefix.patch
    )


src_compile() {
    # Fix ARCH to match linux-headers values
    case ${ARCH} in
        x86)
            ARCH=i386
            ;;
        amd64)
            ARCH=x86_64
            ;;
    esac

    emake mrproper
    emake headers_check
}

src_install() {
    emake INSTALL_HDR_PATH="${D}/usr" headers_install
}
