# Copyright 2008, 2009 Ingmar Vanhassel <ingmar@exherbo.org>
# Distributed under the terms of the GNU General Public License v2
# Based in part upon 'sqlite-3.5.6.ebuild' from Gentoo, which is:
#     Copyright 1999-2008 Gentoo Foundation.

require flag-o-matic

SUMMARY="An embedded SQL database engine"
HOMEPAGE="http://www.sqlite.org/"
DOWNLOADS="http://www.sqlite.org/${PN}-amalgamation-${PV}.tar.gz
    doc? ( http://www.sqlite.org/${PN}_docs_$(ever replace_all _ $(ever range 1-3)).zip )"

REMOTE_IDS="freshmeat:${PN}"

LICENCES="public-domain"
SLOT="3"
PLATFORMS="~amd64 ~ppc64 ~x86"
MYOPTIONS="doc readline unlock-notify"

DEPENDENCIES="
    build:
        doc? ( app-arch/unzip )
    build+run:
        readline? ( sys-libs/readline )
"

DEFAULT_SRC_CONFIGURE_OPTION_ENABLES=( readline )
DEFAULT_SRC_CONFIGURE_PARAMS=( --enable-threadsafe )

src_configure() {
    option unlock-notify && append-cppflags -DSQLITE_ENABLE_UNLOCK_NOTIFY

    default
}

src_install() {
    default

    if option doc ; then
        insinto /usr/share/doc/${PNVR}/html
        doins -r "${WORKBASE}"/${PN}-$(ever replace_all _ $(ever range 1-3))-docs/*
    fi
}

