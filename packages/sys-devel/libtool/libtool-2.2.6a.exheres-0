# Copyright 2007 Bryan Ã˜stergaard
# Copyright 2008 Richard Brown
# Distributed under the terms of the GNU General Public License v2

require gnu [ suffix=lzma ]

SUMMARY="Generic library support script"

LICENCES="GPL-2"
SLOT="0"
PLATFORMS="~amd64 ~arm ~ia64 ~ppc64 ~x86"
MYOPTIONS=""

DEPENDENCIES="
    build:
        sys-devel/autoconf:2.5 [[ note = [
            We patch testsuite.at, so the build system runs autom4te
            automatically.  We can't use eautotest from autotools.exlib
            because the Makefile rules has some extra weird magic
        ] ]]
    build+run:
        sys-devel/gnuconfig"

DEFAULT_SRC_PREPARE_PATCHES=( -p1 "${FILES}"/libtool-2.2.6a-locale.patch )
DEFAULT_SRC_INSTALL_EXTRA_DOCS=( docs/PLATFORMS )

WORK="${WORKBASE}/${PNV%a}"

src_install() {
    default

    for f in $(find "${IMAGE}" -type f -name config.guess -o -name config.sub); do
        rm ${f} || die "Couldn't remove ${f}"
        ln -s /usr/share/gnuconfig/${f##*/} "${f}" || die "Updating ${f} failed."
    done
}

