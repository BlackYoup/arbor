Upstream: No, this is Exherbo specific
Reason: Adjust the loader paths to our multiarch layout

From 44f6688a2379c0954b8dcb8d53d3cf301fbdbb05 Mon Sep 17 00:00:00 2001
From: Niels Ole Salscheider <niels_ole@salscheider-online.de>
Date: Wed, 22 Apr 2015 21:55:09 +0200
Subject: [PATCH 1/2] exherbo multi-arch paths

---
 lib/Driver/Tools.cpp | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/lib/Driver/Tools.cpp b/lib/Driver/Tools.cpp
index 3053d9b..d1e6bde 100644
--- a/lib/Driver/Tools.cpp
+++ b/lib/Driver/Tools.cpp
@@ -7646,7 +7646,7 @@ static std::string getLinuxDynamicLinker(const ArgList &Args,
       return "/system/bin/linker";
   } else if (ToolChain.getArch() == llvm::Triple::x86 ||
              ToolChain.getArch() == llvm::Triple::sparc)
-    return "/lib/ld-linux.so.2";
+    return "/usr/i686-pc-linux-gnu/lib/ld-linux.so.2";
   else if (ToolChain.getArch() == llvm::Triple::aarch64)
     return "/lib/ld-linux-aarch64.so.1";
   else if (ToolChain.getArch() == llvm::Triple::aarch64_be)
@@ -7654,9 +7654,9 @@ static std::string getLinuxDynamicLinker(const ArgList &Args,
   else if (ToolChain.getArch() == llvm::Triple::arm ||
            ToolChain.getArch() == llvm::Triple::thumb) {
     if (ToolChain.getTriple().getEnvironment() == llvm::Triple::GNUEABIHF)
-      return "/lib/ld-linux-armhf.so.3";
+      return "/usr/arm-exherbo-linux-gnueabi/lib/ld-linux-armhf.so.3";
     else
-      return "/lib/ld-linux.so.3";
+      return "/usr/arm-exherbo-linux-gnueabi/lib/ld-linux.so.3";
   } else if (ToolChain.getArch() == llvm::Triple::armeb ||
              ToolChain.getArch() == llvm::Triple::thumbeb) {
     if (ToolChain.getTriple().getEnvironment() == llvm::Triple::GNUEABIHF)
@@ -7685,11 +7685,11 @@ static std::string getLinuxDynamicLinker(const ArgList &Args,
 
     return (LibDir + "/" + LibName).str();
   } else if (ToolChain.getArch() == llvm::Triple::ppc)
-    return "/lib/ld.so.1";
+    return "/usr/powerpc64-unknown-linux-gnueabi/lib/ld.so.1";
   else if (ToolChain.getArch() == llvm::Triple::ppc64) {
     if (ppc::hasPPCAbiArg(Args, "elfv2"))
-      return "/lib64/ld64.so.2";
-    return "/lib64/ld64.so.1";
+      return "/usr/powerpc64-unknown-linux-gnueabi/lib/ld64.so.1";
+    return "/usr/powerpc64-unknown-linux-gnueabi/lib/ld.so.1";
   } else if (ToolChain.getArch() == llvm::Triple::ppc64le) {
     if (ppc::hasPPCAbiArg(Args, "elfv1"))
       return "/lib64/ld64.so.1";
@@ -7700,9 +7700,9 @@ static std::string getLinuxDynamicLinker(const ArgList &Args,
     return "/lib64/ld-linux.so.2";
   else if (ToolChain.getArch() == llvm::Triple::x86_64 &&
            ToolChain.getTriple().getEnvironment() == llvm::Triple::GNUX32)
-    return "/libx32/ld-linux-x32.so.2";
+    return "/usr/x86_64-pc-linux-gnu/lib/ld-linux-x32.so.2";
   else
-    return "/lib64/ld-linux-x86-64.so.2";
+    return "/usr/x86_64-pc-linux-gnu/lib/ld-linux-x86-64.so.2";
 }
 
 static void AddRunTimeLibs(const ToolChain &TC, const Driver &D,
-- 
2.3.3

