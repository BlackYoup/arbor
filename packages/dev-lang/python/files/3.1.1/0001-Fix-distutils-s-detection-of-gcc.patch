Source: Ali Polatel
Upstream: http://bugs.python.org/issue1254718
Reason: Fix build/link faults when using ccache


From dbe5792045ad000dcad7967490a0dedad7830e05 Mon Sep 17 00:00:00 2001
From: Ingmar Vanhassel <ingmar@exherbo.org>
Date: Thu, 20 Aug 2009 05:38:40 +0200
Subject: [PATCH] Fix distutils's detection of gcc.

---
 Lib/distutils/unixccompiler.py |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/Lib/distutils/unixccompiler.py b/Lib/distutils/unixccompiler.py
index c11544d..d3728cb 100644
--- a/Lib/distutils/unixccompiler.py
+++ b/Lib/distutils/unixccompiler.py
@@ -287,7 +287,8 @@ class UnixCCompiler(CCompiler):
         elif sys.platform[:7] == "irix646" or sys.platform[:6] == "osf1V5":
             return ["-rpath", dir]
         else:
-            if compiler[:3] == "gcc" or compiler[:3] == "g++":
+            # This should recognize gcc, g++, gcc-x.y, ccache gcc, etc.
+            if compiler.find("gcc") >= 0 or compiler.find("g++") >= 0:
                 # gcc on non-GNU systems does not need -Wl, but can
                 # use it anyway.  Since distutils has always passed in
                 # -Wl whenever gcc was used in the past it is probably
-- 
1.6.4

