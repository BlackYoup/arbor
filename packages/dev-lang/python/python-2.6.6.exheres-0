# Copyright 2009, 2010 Ingmar Vanhassel
# Distributed under the terms of the GNU General Public License v2

require python-build

PLATFORMS="~amd64 ~arm ~ia64 ~ppc64 ~x86"

src_test() {
    # Fails for fresh installs
    edo rm Lib/distutils/tests/test_build_ext.py

    # needed for test_socket
    esandbox allow_net "unix-abstract:python-test-hello"
    esandbox allow_net "unix-abstract:hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh"

    python-build_src_test
}

src_install() {
    python-build_src_install

    # Installs empty directory.
    edo rmdir "${IMAGE}"/usr/$(get_libdir)/${PN}${SLOT}/lib-old
}

