# Copyright (c) 2007 Alexander Færøy <ahf@exherbo.org>
# Distributed under the terms of the GNU General Public License v2
#
# This is highly inspired from Gentoo's ebuild which is:
#   Copyright 1999-2007 Gentoo Foundation
#

require toolchain-funcs

DESCRIPTION="A library for network packet capturing"
HOMEPAGE="http://www.tcpdump.org/"
SRC_URI="http://www.tcpdump.org/release/${P}.tar.gz"

LICENSE="BSD"
SLOT="0"
PLATFORMS="~x86"
MYOPTIONS="ipv6"

DEPENDENCIES=""

DEFAULT_SRC_CONFIGURE_OPTION_ENABLES="ipv6"

src_compile() {
    default

    $(tc-getCC) ${LDFLAGS} -Wl,-soname,libpcap.so.0 -shared -fPIC -o libpcap.so.${PV:0:3} *.o || die "Unable to generate shared object file"
}

src_install() {
    default

    insopts -m 755
    insinto /usr/$(get_libdir)/
    doins libpcap.so.${PV:0:3}
    dosym libpcap.so.${PV:0:3} /usr/$(get_libdir)/libpcap.so.0
    dosym libpcap.so.${PV:0:3} /usr/$(get_libdir)/libpcap.so
}
