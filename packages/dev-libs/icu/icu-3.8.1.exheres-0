# Copyright 2008 Saleem Abdulrasool <compnerd@compnerd.org>
# Distributed under the terms of the GNU General Purpose License v2

SUMMARY="International Components for Unicode"
HOMEPAGE="http://www.icu-project.org/"
DOWNLOADS="http://download.icu-project.org/files/${PN}4c/${PV}/${PN}4c-${PV//./_}-src.tgz"

LICENCES="BSD"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS=""

DEPENDENCIES=""

WORK="${WORKBASE}/${PN}/source"

DEFAULT_SRC_PREPARE_PATCHES=( -p0 "${FILES}/${PN}-3.8-set-breaktype-public.patch"
                              -p0 "${FILES}/${PN}-3.8-regexp-CVE-2007-4770-4771.patch"
                              -p2 "${FILES}/${PNV}-bare-elif.patch" )
DEFAULT_SRC_CONFIGURE_PARAMS=( '--enable-static' '--with-iostream=std' )

src_prepare() {
    default

    # prevent hardcoding of CFLAGS, LDFLAGS, etc
    for flags in CFLAGS CXXFLAGS CPPFLAGS LDFLAGS ; do
        sed -i -e "/^${flags} =.*/s/@${flags}@//" config/Makefile.inc.in || die
    done
}
