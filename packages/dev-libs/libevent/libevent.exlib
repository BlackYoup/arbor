# Copyright 2009 Wulf C. Krueger
# Distributed under the terms of the GNU General Public License v2
# Based in part upon 'libevent-1.4.3.ebuild' from Gentoo, which is:
#     Copyright 1999-2008 Gentoo Foundation

export_exlib_phases src_test

MY_PNV="${PNV}-stable"

SUMMARY="A library to execute a function when a specific event occurs on a file descriptor"
HOMEPAGE="http://monkey.org/~provos/${PN}/"
DOWNLOADS="http://monkey.org/~provos/${MY_PNV}.tar.gz"

REMOTE_IDS="freshmeat:${PN}"

LICENCES="BSD-3"
SLOT="0"
MYOPTIONS=""
DEPENDENCIES=""

WORK="${WORKBASE}/${MY_PNV}"

DEFAULT_SRC_PREPARE_PATCHES=( "${FILES}/${PN}-2.0.10-test.patch" )

libevent_src_test() {
    pushd test
    edo ./test.sh > "${TEMP}"/tests
    cat "${TEMP}"/tests
    grep -q FAILED "${TEMP}"/tests && die "1 or more tests failed"
    popd
}

