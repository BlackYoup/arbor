# Copyright 2007 Bryan Ã˜stergaard
# Distributed under the terms of the GNU General Public License v2

require eutils

DESCRIPTION="Open source SSL and TLS implementation and cryptographic library"
HOMEPAGE="http://www.openssl.org"
SRC_URI="http://www.openssl.org/source/${P}.tar.gz"

LICENSE="BSD"
SLOT="0"
PLATFORMS="~amd64 ~ia64 ~x86"
MYOPTIONS=""

DEPEND=""
RDEPEND=""

src_compile() {
    ./config --test-sanity || die "Sanity test failed."
    ./config --prefix=/usr --openssldir=/etc/ssl \
        shared threads || die "Configure failed."

    # Fix manpath
    sed -i 's:^MANDIR=.*$:MANDIR=/usr/share/man:' Makefile

    # parallel build is broken
    emake -j1 || die "Make failed."
}

src_install() {
    # .. and parallel installation is also broken
    emake -j1 INSTALL_PREFIX="${D}" install

    dodoc FAQ INSTALL NEWS PROBLEMS README*
}
