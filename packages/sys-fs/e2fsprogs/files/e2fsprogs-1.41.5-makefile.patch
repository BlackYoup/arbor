From: <toyj@union.edu>, parts from Wulf C. Krueger <philantrop@exherbo.org> 
Date: Sun, 26 Apr 2009 13:46:02 +0200
Subject: [PATCH] Reason: patches makefiles for sane install
Upstream: Wants it as it is.

---
 Makefile.in          |    2 +-
 e2fsck/Makefile.in   |   16 ++++++++--------
 lib/Makefile.elf-lib |    2 +-
 lib/uuid/Makefile.in |    4 ++--
 misc/Makefile.in     |   20 ++++++++++----------
 5 files changed, 22 insertions(+), 22 deletions(-)

diff --git a/Makefile.in b/Makefile.in
index 1f1b8ea..9fb89ce 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -58,7 +58,7 @@ distclean-doc:
 
 install: subs all-libs-recursive install-progs-recursive \
   install-shlibs-libs-recursive install-doc-libs
-	if test ! -d e2fsck && test ! -d debugfs && test ! -d misc && test ! -d ext2ed ; then $(MAKE) install-libs ; fi
+	$(MAKE) install-libs
 
 install-strip: subs all-libs-recursive install-strip-progs-recursive \
   install-shlibs-strip-libs-recursive install-doc-libs
diff --git a/e2fsck/Makefile.in b/e2fsck/Makefile.in
index 9d974bb..3f6f25d 100644
--- a/e2fsck/Makefile.in
+++ b/e2fsck/Makefile.in
@@ -195,16 +195,16 @@ install: $(PROGS) $(MANPAGES) $(FMANPAGES) installdirs
 		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(root_sbindir)/$$i; \
 	done
 	@echo "	LINK $(root_sbindir)/fsck.ext2"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	@$(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext2
 	@echo "	LINK $(root_sbindir)/fsck.ext3"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	@$(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext3
 	@echo "	LINK $(root_sbindir)/fsck.ext4"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	@$(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext4
 	@echo "	LINK $(root_sbindir)/fsck.ext4dev"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	@$(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext4dev
 	@for i in $(MANPAGES); do \
 		for j in $(COMPRESS_EXT); do \
@@ -221,16 +221,16 @@ install: $(PROGS) $(MANPAGES) $(FMANPAGES) installdirs
 		$(INSTALL_DATA) $$i $(DESTDIR)$(man5dir)/$$i; \
 	done
 	@echo "	LINK $(man8dir)/fsck.ext2.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	@$(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext2.8
 	@echo "	LINK $(man8dir)/fsck.ext3.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	@$(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext3.8
 	@echo "	LINK $(man8dir)/fsck.ext4.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	@$(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext4.8
 	@echo "	LINK $(man8dir)/fsck.ext4.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	@$(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext4dev.8
 
 install-strip: install
diff --git a/lib/Makefile.elf-lib b/lib/Makefile.elf-lib
index 4c778b9..95bd34f 100644
--- a/lib/Makefile.elf-lib
+++ b/lib/Makefile.elf-lib
@@ -48,7 +48,7 @@ install-shlibs install:: $(ELF_LIB) installdirs-elf-lib
 	@if test "$(ELF_INSTALL_DIR)" = "$(libdir)"; then \
 		$(LN_S) -f $(ELF_SONAME) $(DESTDIR)$(libdir)/$(ELF_IMAGE).so ; \
 	else \
-		$(LN_S) -f $(ELF_INSTALL_DIR)/$(ELF_SONAME) \
+		$(LN_S) -f $(ELF_SONAME) \
 			$(DESTDIR)$(libdir)/$(ELF_IMAGE).so; \
 	fi			
 	@echo "	LDCONFIG"
diff --git a/lib/uuid/Makefile.in b/lib/uuid/Makefile.in
index 35fc2e9..eed08b8 100644
--- a/lib/uuid/Makefile.in
+++ b/lib/uuid/Makefile.in
@@ -146,9 +146,9 @@ install:: all installdirs
 	@$(RM) -f $(DESTDIR)$(man3dir)/uuid_generate_random.3.gz \
 		$(DESTDIR)$(man3dir)/uuid_generate_time.3.gz
 	@echo "	LINK $(man3dir)/uuid_generate_random.3"
-	@$(LN) -f $(DESTDIR)$(man3dir)/uuid_generate.3 $(DESTDIR)$(man3dir)/uuid_generate_random.3
+	@$(LN) -f uuid_generate.3 $(DESTDIR)$(man3dir)/uuid_generate_random.3
 	@echo "	LINK $(man3dir)/uuid_generate_time.3"
-	@$(LN) -f $(DESTDIR)$(man3dir)/uuid_generate.3 $(DESTDIR)$(man3dir)/uuid_generate_time.3
+	@$(LN) -f uuid_generate.3 $(DESTDIR)$(man3dir)/uuid_generate_time.3
 	@echo "	INSTALL_DATA $(libdir)/pkgconfig/uuid.pc"
 	@$(INSTALL_DATA) uuid.pc $(DESTDIR)$(libdir)/pkgconfig/uuid.pc
 
diff --git a/misc/Makefile.in b/misc/Makefile.in
index 99cb149..e56a4e7 100644
--- a/misc/Makefile.in
+++ b/misc/Makefile.in
@@ -394,23 +394,23 @@ install: all $(SMANPAGES) $(UMANPAGES) installdirs
 		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(sbindir)/$$i; \
 	done
 	@echo "	LINK $(root_sbindir)/mkfs.ext2"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	@$(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext2
 	@echo "	LINK $(root_sbindir)/mkfs.ext3"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	@$(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext3
 	@echo "	LINK $(root_sbindir)/mkfs.ext4"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	@$(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext4
 	@echo "	LINK $(root_sbindir)/mkfs.ext4dev"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	@$(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext4dev
 	@echo "	LINK $(root_sbindir)/e2label"
-	@$(LN) -f $(DESTDIR)$(root_sbindir)/tune2fs \
+	@$(LN) -f tune2fs \
 		$(DESTDIR)$(root_sbindir)/e2label
 	@if test -n "$(FINDFS_LINK)"; then \
 		echo "  LINK $(root_sbindir)/findfs"; \
-		$(LN) -f $(DESTDIR)$(root_sbindir)/tune2fs \
+		$(LN) -f tune2fs \
 			$(DESTDIR)$(root_sbindir)/$(FINDFS_LINK); \
 	fi
 	@for i in $(UPROGS); do \
@@ -431,16 +431,16 @@ install: all $(SMANPAGES) $(UMANPAGES) installdirs
 	@$(RM) -f $(DESTDIR)$(man8dir)/mkfs.ext2.8.gz \
 		$(DESTDIR)$(man8dir)/mkfs.ext3.8.gz
 	@echo "	LINK mkfs.ext2.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	@$(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext2.8
 	@echo "	LINK mkfs.ext3.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	@$(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext3.8
 	@echo "	LINK mkfs.ext4.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	@$(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext4.8
 	@echo "	LINK mkfs.ext4dev.8"
-	@$(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	@$(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext4dev.8
 	@for i in $(UMANPAGES); do \
 		for j in $(COMPRESS_EXT); do \
-- 
1.6.2.2

