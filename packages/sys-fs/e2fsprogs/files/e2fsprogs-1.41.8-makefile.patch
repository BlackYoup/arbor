From: <toyj@union.edu>, parts from Wulf C. Krueger <philantrop@exherbo.org> 
Date: Sun, 26 Apr 2009 13:46:02 +0200
Subject: [PATCH] Reason: patches makefiles for sane install
Upstream: Wants it as it is.

Edited by Daniel Mierswa <impulze@impulze.org> to match 1.41.8

---
 Makefile.in          |    2 +-
 e2fsck/Makefile.in   |   16 ++++++++--------
 lib/Makefile.elf-lib |    2 +-
 misc/Makefile.in     |   20 ++++++++++----------
 4 files changed, 20 insertions(+), 20 deletions(-)

diff --git a/Makefile.in b/Makefile.in
index 1f1b8ea..9fb89ce 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -59,7 +59,7 @@ distclean-doc:
 
 install: subs all-libs-recursive install-progs-recursive \
   install-shlibs-libs-recursive install-doc-libs
-	if test ! -d e2fsck && test ! -d debugfs && test ! -d misc && test ! -d ext2ed ; then $(MAKE) install-libs ; fi
+	$(MAKE) install-libs
 
 install-strip: subs all-libs-recursive install-strip-progs-recursive \
   install-shlibs-strip-libs-recursive install-doc-libs
diff --git a/e2fsck/Makefile.in b/e2fsck/Makefile.in
index 9d974bb..3f6f25d 100644
--- a/e2fsck/Makefile.in
+++ b/e2fsck/Makefile.in
@@ -202,16 +202,16 @@ install: $(PROGS) $(MANPAGES) $(FMANPAGES) installdirs
 		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(root_sbindir)/$$i; \
 	done
 	$(E) "	LINK $(root_sbindir)/fsck.ext2"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	$(Q) $(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext2
 	$(E) "	LINK $(root_sbindir)/fsck.ext3"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	$(Q) $(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext3
 	$(E) "	LINK $(root_sbindir)/fsck.ext4"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	$(Q) $(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext4
 	$(E) "	LINK $(root_sbindir)/fsck.ext4dev"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/e2fsck \
+	$(Q) $(LN) -f e2fsck \
 			$(DESTDIR)$(root_sbindir)/fsck.ext4dev
 	$(Q) for i in $(MANPAGES); do \
 		for j in $(COMPRESS_EXT); do \
@@ -228,16 +228,16 @@ install: $(PROGS) $(MANPAGES) $(FMANPAGES) installdirs
 		$(INSTALL_DATA) $$i $(DESTDIR)$(man5dir)/$$i; \
 	done
 	$(E) "	LINK $(man8dir)/fsck.ext2.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	$(Q) $(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext2.8
 	$(E) "	LINK $(man8dir)/fsck.ext3.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	$(Q) $(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext3.8
 	$(E) "	LINK $(man8dir)/fsck.ext4.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	$(Q) $(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext4.8
 	$(E) "	LINK $(man8dir)/fsck.ext4.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/e2fsck.8 \
+	$(Q) $(LN) -f e2fsck.8 \
 		$(DESTDIR)$(man8dir)/fsck.ext4dev.8
 
 install-strip: install
diff --git a/lib/Makefile.elf-lib b/lib/Makefile.elf-lib
index 4c778b9..95bd34f 100644
--- a/lib/Makefile.elf-lib
+++ b/lib/Makefile.elf-lib
@@ -48,7 +48,7 @@ install-shlibs install:: $(ELF_LIB) installdirs-elf-lib
 	$(Q) if test "$(ELF_INSTALL_DIR)" = "$(libdir)"; then \
 		$(LN_S) -f $(ELF_SONAME) $(DESTDIR)$(libdir)/$(ELF_IMAGE).so ; \
 	else \
-		$(LN_S) -f $(ELF_INSTALL_DIR)/$(ELF_SONAME) \
+		$(LN_S) -f $(ELF_SONAME) \
 			$(DESTDIR)$(libdir)/$(ELF_IMAGE).so; \
 	fi			
 	$(E) "	LDCONFIG"
diff --git a/misc/Makefile.in b/misc/Makefile.in
index 99cb149..e56a4e7 100644
--- a/misc/Makefile.in
+++ b/misc/Makefile.in
@@ -395,23 +395,23 @@ install: all $(SMANPAGES) $(UMANPAGES) installdirs
 		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(sbindir)/$$i; \
 	done
 	$(E) "	LINK $(root_sbindir)/mkfs.ext2"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	$(Q) $(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext2
 	$(E) "	LINK $(root_sbindir)/mkfs.ext3"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	$(Q) $(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext3
 	$(E) "	LINK $(root_sbindir)/mkfs.ext4"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	$(Q) $(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext4
 	$(E) "	LINK $(root_sbindir)/mkfs.ext4dev"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/mke2fs \
+	$(Q) $(LN) -f mke2fs \
 		$(DESTDIR)$(root_sbindir)/mkfs.ext4dev
 	$(E) "	LINK $(root_sbindir)/e2label"
-	$(Q) $(LN) -f $(DESTDIR)$(root_sbindir)/tune2fs \
+	$(Q) $(LN) -f tune2fs \
 		$(DESTDIR)$(root_sbindir)/e2label
 	$(Q) if test -n "$(FINDFS_LINK)"; then \
 		echo "  LINK $(root_sbindir)/findfs"; \
-		$(LN) -f $(DESTDIR)$(root_sbindir)/tune2fs \
+		$(LN) -f tune2fs \
 			$(DESTDIR)$(root_sbindir)/$(FINDFS_LINK); \
 	fi
 	$(Q) for i in $(UPROGS); do \
@@ -432,16 +432,16 @@ install: all $(SMANPAGES) $(UMANPAGES) installdirs
 	$(Q) $(RM) -f $(DESTDIR)$(man8dir)/mkfs.ext2.8.gz \
 		$(DESTDIR)$(man8dir)/mkfs.ext3.8.gz
 	$(E) "	LINK mkfs.ext2.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	$(Q) $(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext2.8
 	$(E) "	LINK mkfs.ext3.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	$(Q) $(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext3.8
 	$(E) "	LINK mkfs.ext4.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	$(Q) $(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext4.8
 	$(E) "	LINK mkfs.ext4dev.8"
-	$(Q) $(LN) -f $(DESTDIR)$(man8dir)/mke2fs.8 \
+	$(Q) $(LN) -f mke2fs.8 \
 		$(DESTDIR)$(man8dir)/mkfs.ext4dev.8
 	$(Q) for i in $(UMANPAGES); do \
 		for j in $(COMPRESS_EXT); do \
-- 
1.6.2.2

