# Copyright 2007 Mike Kelly
# Distributed under the terms of the GPLv2

require bash-completion

DESCRIPTION="A distributed version control system focused on speed, effectivity
and real-world usability on large projects."
HOMEPAGE="http://git.or.cz/"
SRC_URI="
    mirror://kernel/software/scm/${PN}/${P}.tar.bz2
    mirror://kernel/software/scm/${PN}/${PN}-manpages-${PV}.tar.bz2"

LICENSE="GPL-2"
SLOT="0"
PLATFORMS="~x86"
MYOPTIONS=""

DEPENDENCIES="
    build,run:
	app-arch/cpio
	dev-lang/perl
	sys-libs/zlib
	dev-libs/openssl"

src_unpack()
{
    unpack "${P}.tar.bz2"
    cd "${S}"
    unpack "${PN}-manpages-${PV}.tar.bz2"
}

src_install()
{
    emake DESTDIR="${D}" install || die "emake install failed"

    doman man?/*

    dodoc README Documentation/{SubmittingPatches,CodingGuidelines}
	for d in / /howto/ /technical/ ; do
		docinto ${d}
		dodoc Documentation${d}*.txt
	done
	docinto /

    dobashcompletion contrib/completion/git-completion.bash ${PN}
}

src_test()
{
    emake test || die "emake test failed"
}
