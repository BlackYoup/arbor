From b68e05c3b78c19ae06003281adaa2736cb53e605 Mon Sep 17 00:00:00 2001
From: Chris Liddell <chris.liddell@artifex.com>
Date: Fri, 9 Oct 2015 10:54:10 +0100
Subject: [PATCH] Bug 696246: devijs account for device sublassing.

The IJS device wasn't coping with the possibility it had been subclassed.

No cluster differences
---
 devices/gdevijs.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/devices/gdevijs.c b/devices/gdevijs.c
index 5520716..a2e21ea 100644
--- a/devices/gdevijs.c
+++ b/devices/gdevijs.c
@@ -827,6 +827,10 @@ gsijs_open(gx_device *dev)
     if (code < 0)
         return code;
 
+    while (dev->child)
+        dev = dev->child;
+    ijsdev = (gx_device_ijs *)dev;
+
     if (use_outputfd) {
         /* Note: dup() may not be portable to all interesting IJS
            platforms. In that case, this branch should be #ifdef'ed out.
-- 
2.5.1

